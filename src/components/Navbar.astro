---
import { Button } from '@/components/ui/button'
import { Image } from "astro:assets";
import profilePic from "../assets/profile.webp";
import Profile from './Profile.astro';
---

<div class="sticky top-0 w-full z-50 py-4 px-4 sm:px-8 border-b border-b-mochaborder bg-mochablack flex flex-row justify-between items-center">
    <Profile />

    <!-- Desktop Navigation -->
    <div class="hidden lg:flex gap-4 flex-row">
        <a href="/#about">
            <Button class="bg-mochasurface hover:bg-mochasurfacelight/50 border border-mochaborder text-mochawhite cursor-pointer">À propos</Button>
        </a>
        <a href="/#skills">
            <Button class="bg-mochasurface hover:bg-mochasurfacelight/50 border border-mochaborder text-mochawhite cursor-pointer">Compétences</Button>
        </a>
        <a href="/#projects">
            <Button class="bg-mochasurface hover:bg-mochasurfacelight/50 border border-mochaborder text-mochawhite cursor-pointer">Projets</Button>
        </a>
        <a href="/#experience">
            <Button class="bg-mochasurface hover:bg-mochasurfacelight/50 border border-mochaborder text-mochawhite cursor-pointer">Expérience</Button>
        </a>
    </div>

 

    <!-- Mobile Hamburger Menu -->
    <button id="mobile-menu-button" class="lg:hidden flex flex-col gap-1 p-2 z-50 relative">
        <div class="hamburger-line w-6 h-0.5 bg-mochawhite transition-all duration-300"></div>
        <div class="hamburger-line w-6 h-0.5 bg-mochawhite transition-all duration-300"></div>
        <div class="hamburger-line w-6 h-0.5 bg-mochawhite transition-all duration-300"></div>
    </button>

    <!-- Mobile Dropdown Menu -->
    <div id="mobile-menu" class="absolute top-full left-0 right-0 bg-mochablack border-b border-mochaborder opacity-0 invisible transform translate-y-2 transition-all duration-300 z-40 lg:hidden">
        <div class="flex flex-col p-4 gap-3">
            <a href="#about" class="mobile-nav-link">
                <Button class="w-full bg-mochasurface hover:bg-mochasurfacelight/50 border border-mochaborder text-mochawhite cursor-pointer">À propos</Button>
            </a>
            <a href="#skills" class="mobile-nav-link">
                <Button class="w-full bg-mochasurface hover:bg-mochasurfacelight/50 border border-mochaborder text-mochawhite cursor-pointer">Compétences</Button>
            </a>
            <a href="#experience" class="mobile-nav-link">
                <Button class="w-full bg-mochasurface hover:bg-mochasurfacelight/50 border border-mochaborder text-mochawhite cursor-pointer">Expérience</Button>
            </a>
            <a href="#projects" class="mobile-nav-link">
                <Button class="w-full bg-mochasurface hover:bg-mochasurfacelight/50 border border-mochaborder text-mochawhite cursor-pointer">Projets</Button>
            </a>
           

        </div>
    </div>
</div>

<style>
    .mobile-menu-open .hamburger-line:nth-child(1) {
        transform: rotate(45deg) translate(5px, 5px);
    }

    .mobile-menu-open .hamburger-line:nth-child(2) {
        opacity: 0;
    }

    .mobile-menu-open .hamburger-line:nth-child(3) {
        transform: rotate(-45deg) translate(7px, -6px);
    }
</style>

<script>
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    const mobileNavLinks = document.querySelectorAll('.mobile-nav-link');

    function toggleMobileMenu() {
        const isOpen = mobileMenu?.classList.contains('opacity-100');

        if (isOpen) {
            // Close menu
            mobileMenu?.classList.remove('opacity-100', 'visible', 'translate-y-0');
            mobileMenu?.classList.add('opacity-0', 'invisible', 'translate-y-2');
            mobileMenuButton?.classList.remove('mobile-menu-open');
        } else {
            // Open menu
            mobileMenu?.classList.remove('opacity-0', 'invisible', 'translate-y-2');
            mobileMenu?.classList.add('opacity-100', 'visible', 'translate-y-0');
            mobileMenuButton?.classList.add('mobile-menu-open');
        }
    }

    function closeMobileMenu() {
        mobileMenu?.classList.remove('opacity-100', 'visible', 'translate-y-0');
        mobileMenu?.classList.add('opacity-0', 'invisible', 'translate-y-2');
        mobileMenuButton?.classList.remove('mobile-menu-open');
    }

    // Toggle menu on hamburger button click
    mobileMenuButton?.addEventListener('click', toggleMobileMenu);

    // Close menu when clicking navigation links
    mobileNavLinks.forEach(link => {
        link.addEventListener('click', closeMobileMenu);
    });

    // Close menu on escape key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            closeMobileMenu();
        }
    });

    // Close menu when clicking outside
    document.addEventListener('click', (e) => {
        const isClickInsideMenu = mobileMenu?.contains(e.target as Node);
        const isClickOnButton = mobileMenuButton?.contains(e.target as Node);

        if (!isClickInsideMenu && !isClickOnButton) {
            closeMobileMenu();
        }
    });

    // Handle window resize
    window.addEventListener('resize', () => {
        if (window.innerWidth >= 1024) {
            closeMobileMenu();
        }
    });
</script>